---
title: "Mini-Project 2"
author: "Thao Phan & Asmita Gautam"
date: "March 24, 2017"
output: html_document
---


## Loading the data
## save changes, I pull & commit, Asmita will push.

```{r, warning=FALSE, message=FALSE}
install.packages( c("shiny", "htmlwidgets"))
library(shiny)
library(htmlwidgets)
library(tidyverse)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

# below is a function I wrote. It's pretty self-explanatory when you look at it. 
# s1, s2, s3, s4 etc. stands for the states 


```{r}
# FUNCTION 1: lets you compare any two parties in any 11 eleven states in candidates data set
candidatesFunction <- function( party1, party2, s1, s2, s3, s4, s5, s6, s7, s8, s9, s10, s11 ) {
  candidates %>%
    filter( cand_party_affiliation == c( party1, party2 ) ) %>%
    filter( cand_office_state == c( s1, s2, s3, s4, s5, s6, s7, s8, s9, s10, s11 ) ) %>%
    group_by( cand_party_affiliation, cand_office_state ) %>%
    summarise( n = n() )
}
```

```{r, warning=FALSE, message=FALSE}
test_Cand_Funct <- candidatesFunction( party1 = "DEM", party2 = "REP", s1 = "CA", s2 = "TX", s3 = "NY", s4 = "FL", s5 = "PA", s6 = "IL", s7  = "OH", s8 = "MI", s9 = "GA", s10 = "NC", s11 = "NJ" )
```


```{r}
ggplot( test_Cand_Funct, aes(x = cand_office_state, y = n, fill = cand_party_affiliation, width = .5)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("TEST GRAPH FOR COMMITTEE FUNCTION: 
          Candidates in Top Ten Electoral Vote States") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2")))
```


# Candidates in Southern States
```{r, warning=FALSE, message=FALSE}
south_cand <- candidatesFunction( party1 = "DEM", party2 = "REP", s1 = "AL", s2 = "KY", s3 = "MS", s4 = "TN", s5 = "AR", s6 = "LA", s7  = "TX", s8 = "GA", s9 = "FL", s10 = "VA", s11 = "NC" )
```

```{r}
ggplot( south_cand, aes(x = cand_office_state, y = n, fill = cand_party_affiliation, width = .5)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("Candidates in Southern States") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2")))
```



# Candidates in Western States
```{r, warning=FALSE, message=FALSE}
mount_cand <- candidatesFunction( party1 = "DEM", party2 = "REP", s1 = "MO", s2 = "WY", s3 = "CO", s4 = "NM", s5 = "ID", s6 = "UT", s7  = "AZ", s8 = "NV", s9 = "WA", s10 = "OR", s11 = "CA" )
```

```{r}
ggplot( mount_cand, aes(x = cand_office_state, y = n, fill = cand_party_affiliation, width = .5)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("Candidates in Western States") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2")))
```






```{r}
# FUNCTION 2: lets you compare any two parties in any 11 eleven states in committees data set
committeesFunction <- function( party1, party2, s1, s2, s3, s4, s5, s6, s7, s8, s9, s10, s11 ) {
  committees %>%
    filter( cmte_party_affiliation == c( party1, party2 ) ) %>%
    filter( cmte_state == c( s1, s2, s3, s4, s5, s6, s7, s8, s9, s10, s11 ) ) %>%
    group_by( cmte_party_affiliation, cmte_state ) %>%
    summarise( n = n() )
}
```

```{r, warning=FALSE, message=FALSE}
test_Commit_Funct <- committeesFunction( party1 = "DEM", party2 = "REP", s1 = "CA", s2 = "TX", s3 = "NY", s4 = "FL", s5 = "PA", s6 = "IL", s7  = "OH", s8 = "MI", s9 = "GA", s10 = "NC", s11 = "NJ" )
```

```{r}
ggplot( test_Commit_Funct, aes(x = cmte_state, y = n, fill = cmte_party_affiliation, width = .5) ) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("TEST GRAPH FOR COMMITTEE FUNCTION") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2")))
```







```{r}
# FUNCTION 3: lets you compare any two parties in any 11 eleven states in house_elections data set
houseFunction <- function( party1, party2, s1, s2, s3, s4, s5, s6, s7, s8, s9, s10, s11 ) {
  house_elections %>%
    filter( party == c( party1, party2 ) ) %>%
    filter( state == c( s1, s2, s3, s4, s5, s6, s7, s8, s9, s10, s11 ) ) %>%
    group_by( party, state ) %>%
    summarise( n = n() )
}
```

```{r, warning=FALSE, message=FALSE}
test_House_Funct <- houseFunction( party1 = "DEM", party2 = "REP", s1 = "CA", s2 = "TX", s3 = "NY", s4 = "FL", s5 = "PA", s6 = "IL", s7  = "OH", s8 = "MI", s9 = "GA", s10 = "NC", s11 = "NJ" )
```

```{r} 
# For some reason, this ggplot does not work. I'm not sure why. 
ggplot( test_House_Funct, aes(x = state, y = n, fill = party, width = .5) ) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("TEST PLOT FOR HOUSE FUNCTION
          Are there more Democrats or Republicans running for House Elections?") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2")))

```












# BELOW IS ALL THE CODE WITHOUT THE FUNCTIONS
```{r, warning=FALSE, message=FALSE}
cand1 <- candidates %>%
  filter(cand_party_affiliation == c("DEM", "REP")) %>%
  filter(cand_office_state == c("CA", "TX", "NY", "FL", "PA", "IL", "OH", "MI", "GA", "NC", "NJ")) %>%
  group_by(cand_party_affiliation, cand_office_state) %>%
  summarise( n = n() )
```

```{r}
ggplot( cand1, aes(x = cand_office_state, y = n, fill = cand_party_affiliation, width = .5)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("Candidates in Top Ten Electoral Vote States") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2")))
```

```{r, warning=FALSE, message=FALSE}
com1 <- committees %>%
  filter(cmte_party_affiliation == c("DEM", "REP")) %>%
  filter(cmte_state == c("CA", "TX", "NY", "FL", "PA", "IL", "OH", "MI", "GA", "NC", "NJ")) %>%
  group_by(cmte_party_affiliation, cmte_state) %>%
  summarise( n = n() )
```

```{r}
ggplot( com1, aes(x = cmte_state, y = n, fill = cmte_party_affiliation, width = .5)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("Committee graph") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2")))
```

```{r, warning=FALSE, message=FALSE}
party_affiliation <- house_elections %>%
  filter( party == c("D", "R") )%>%
  filter( state == c("CA", "TX", "NY", "FL", "PA", "IL", "OH", "MI", "GA", "NC", "NJ" )) %>%
  group_by( party, state ) %>%
  summarise( n = n() )
```

```{r}
ggplot(party_affiliation, aes(x = state, y = n, fill = party, width = .5)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("Are there more Democrats or Republicans running for House Elections?") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2")))

# In the chart above, we analyzed the political party affiliations of the 2011-2012 candidates (in the top ten electoral vote states) for the House of Representative. What we found was interesting. California, which leans more Democratic than Republican had more Republican candidates running for the House of Rep. Also, what we also found interesting was that several states (Florida, Ohio, N.Carolina, N.Jersey, and Pennsylvania) had just one party running for the house. We're not sure why this is, but we think that maybe it's because those states are primarily supportive of that particular party (whether Democrat or Republican) and this support is so strong that it probably makes candidates in the opposing party not run. This is just a hypothesis.  
```







# JOINED DATA
```{r}
#rm(contributions, committees)
joined_data <- committees %>%
   inner_join(contributions, by = "cmte_id")
```

```{r}
filtered_data <- joined_data %>%
  filter( cmte_state == c("CA", "TX", "NY", "FL", "PA", "IL", "OH", "MI", "GA", "NC", "NJ" )) 
```

```{r}
joined_data
```







