---
title: "Mini-Project 2"
author: "Thao Phan & Asmita Gautam"
date: "March 24, 2017"
output: html_document
---


## Loading the data
## save changes, I pull & commit, Asmita will push.

```{r, warning=FALSE, message=FALSE}
#install.packages("shiny")
#install.packages("htmlwidgets")
library(shiny)
library(htmlwidgets)
library(tidyverse)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```


```{r, warning=FALSE, message=FALSE}
# Function for ggplot that plots candidate data  
cand_ggPlot_func <- function( data, title, legendName, xLabel, yLabel){
  
  ggplot( data, aes(x = cand_office_state, y = n, fill = cand_party_affiliation, width = .5)) +  
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle(title) +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2"))) +
  labs( fill = legendName ) +
  labs(x = xLabel) +
  labs(y = yLabel)
}
```


```{r}
# FUNCTION 1: "candidatesFunc"
# lets you compare candidate party affiliations for any two parties in any 11 eleven states in candidates data set
# s1, s2, s3, s4 etc. stands for the states 

candidatesFunc <- function( party1, party2, s1, s2, s3, s4, s5, s6, s7, s8, s9, s10, s11 ) {
  candidates %>%
    filter( cand_party_affiliation == c( party1, party2 ) ) %>%
    filter( cand_office_state == c( s1, s2, s3, s4, s5, s6, s7, s8, s9, s10, s11 ) ) %>%
    group_by( cand_party_affiliation, cand_office_state ) %>%
    summarise( n = n() )
}
```


```{r, warning=FALSE, message=FALSE}
# Below we use the candidatesFunction

# Candidate Party affiliation in Top Ten Electoral Vote States
# States: CA, FL, GA, IL, MI, NC, NJ, NY, OH, PA, TX
top_10 <- candidatesFunc( party1 = "DEM", party2 = "REP", s1 = "CA", s2 = "FL", s3 = "GA", s4 = "IL", s5 = "MI", s6 = "NC", s7  = "NJ", s8 = "NY", s9 = "OH", s10 = "PA", s11 = "TX" )
```

```{r}
ggplot( top_10, aes(x = cand_office_state, y = n, fill = cand_party_affiliation, width = .5)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("Candidate Party Affiliation in Top Ten Electoral Vote States") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2"))) +
  labs( fill = "Candidate Party Affiliation") +
  labs(x = "Candidate's Office State") +
  labs(y = " # of Candidates in Each Party")
```


```{r, warning=FALSE, message=FALSE}
# Candidates in North Eastern States
# States: CT MA ME NH NJ NY PA RI VT 
north_cand <- candidatesFunc( party1 = "DEM", party2 = "REP", s1 = "CT", s2 = "MA", s3 = "ME", s4 = "NH", s5 = "NJ", s6 = "NY", s7  = "PA", s8 = "RI", s9 = "VT", s10 = "0", s11 = "0" )
```


```{r}
cand_ggPlot_func( north_cand, "Candidate Party Affiliation in North Eastern States", "Candidate Party Affiliation", "Candidate's Office State", "# of Candidates in Each Party" )
```



```{r}
ggplot( north_cand, aes(x = cand_office_state, y = n, fill = cand_party_affiliation, width = .5)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("Candidate Party Affiliation in North Eastern States") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2"))) +
  labs( fill = "Candidate Party Affiliation") +
  labs(x = "Candidate's Office State") +
  labs(y = " # of Candidates in Each Party")

```

#-----------------------------------#################--------------------------------------------------------------#


```{r}
# FUNCTION 2: "committeesFunc"
# lets you compare any two parties in any 11 eleven states in committees data set
committeesFunc <- function( party1, party2, s1, s2, s3, s4, s5, s6, s7, s8, s9, s10, s11 ) {
  committees %>%
    filter( cmte_party_affiliation == c( party1, party2 ) ) %>%
    filter( cmte_state == c( s1, s2, s3, s4, s5, s6, s7, s8, s9, s10, s11 ) ) %>%
    group_by( cmte_party_affiliation, cmte_state ) %>%
    summarise( n = n() )
}
```


```{r, warning=FALSE, message=FALSE}
# Committee Party affiliation in Top Ten Electoral Vote States
# States: CA, FL, GA, IL, MI, NC, NJ, NY, OH, PA, TX
top_10_cmte <- committeesFunc( party1 = "DEM", party2 = "REP", s1 = "CA", s2 = "FL", s3 = "GA", s4 = "IL", s5 = "MI", s6 = "NC", s7  = "NJ", s8 = "NY", s9 = "OH", s10 = "PA", s11 = "TX" )
```

```{r}
ggplot( top_10_cmte, aes(x = cmte_state, y = n, fill = cmte_party_affiliation, width = .5) ) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("Committee Party Affiliation in Top Ten Electoral Vote States") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2"))) +
  labs( fill = "Committee Party Affiliation") +
  labs(x = "Committee's State") +
  labs(y = "# of Committees in Each Party")

```


```{r, warning=FALSE, message=FALSE}
# Committees Party Affiliation in Northeastern States
# States: AZ, CA, CO, ID, MO, NM, NV, OR, UT, WA, WY
north_com <- committeesFunc( party1 = "DEM", party2 = "REP", s1 = "CT", s2 = "MA", s3 = "ME", s4 = "NH", s5 = "NJ", s6 = "NY", s7  = "PA", s8 = "RI", s9 = "VT", s10 = "0", s11 = "0"  )
```

```{r}
ggplot( north_com, aes(x = cmte_state, y = n, fill = cmte_party_affiliation, width = .5) ) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("Committee Party Affiliation in Northeastern States") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2"))) +
  labs( fill = "Committee Party Affiliation") +
  labs(x = "Committee's State") +
  labs(y = "# of Committees in Each Party")
```


#-----------------------------------#################--------------------------------------------------------------#

```{r, warning=FALSE, message=FALSE}
# Write a function for ggplot 
ggplotFunc<- function( data, party, state, title, legendName, xLabel, yLabel){
  ggplot( data, aes(x = state, y = n, fill = party, width = .5)) +  
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle(title) +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2"))) +
  labs( fill = legendName ) +
  labs(x = xLabel) +
  labs(y = yLabel)
}
```

# ```{r, warning=FALSE, message=FALSE}
# ggplotFunc( south_com, cmte_party_affiliation, cmte_state, "Committee Party Affiliation in Southern States", "Committee Party Affiliation", "Committee's State", "# of Committees in Each Party" )
# ```






```{r, warning=FALSE, message=FALSE}

# BELOW IS ALL THE CODE WITHOUT THE FUNCTIONS

# NOTE: I changed the order of the states in the filter() so that they are in alphabetical order
# ABC ORDER: CA, FL, GA, IL, MI, NC, NJ, NY, OH, PA, TX
cand1 <- candidates %>%
  filter(cand_party_affiliation == c("DEM", "REP")) %>%
  filter(cand_office_state == c("CA", "FL", "GA", "IL", "MI", "NC", "NJ", "NY", "OH", "PA", "TX")) %>%
  group_by(cand_party_affiliation, cand_office_state) %>%
  summarise( n = n() )
```

```{r}
ggplot( cand1, aes(x = cand_office_state, y = n, fill = cand_party_affiliation, width = .5)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("Candidates in Top Ten Electoral Vote States") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2"))) +
  labs( fill = "Candidate Party Affiliation") +
  labs(x = "Candidate's Office State") +
  labs(y = " # of Candidates in Each Party")

```

```{r, warning=FALSE, message=FALSE}
com1 <- committees %>%
  filter(cmte_party_affiliation == c("DEM", "REP")) %>%
  filter(cmte_state == c("CA", "FL", "GA", "IL", "MI", "NC", "NJ", "NY", "OH", "PA", "TX")) %>%
  group_by(cmte_party_affiliation, cmte_state) %>%
  summarise( n = n() )
```

```{r}
ggplot( com1, aes(x = cmte_state, y = n, fill = cmte_party_affiliation, width = .5)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("Committee Party Affiliation in Top Ten Electoral Vote States") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2"))) +
  labs( fill = "Committee Party Affiliation") +
  labs(x = "Committee's State") +
  labs(y = " # of Committees in Each Party")

```

```{r, warning=FALSE, message=FALSE}
party_affiliation <- house_elections %>%
  filter( party == c("D", "R") )%>%
  filter( state == c("CA", "FL", "GA", "IL", "MI", "NC", "NJ", "NY", "OH", "PA", "TX")) %>%
  group_by( party, state ) %>%
  summarise( n = n() )
```

```{r}
ggplot(party_affiliation, aes(x = state, y = n, fill = party, width = .5)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  theme_minimal() +
  ggtitle("Are there more Democrats or Republicans running for House Elections?") +
  scale_fill_manual(values = alpha(c("steelblue2", "indianred2"))) +
  labs( fill = "Political Party") +
  labs(x = "State & How Many Candidates Are in Each Party") +
  labs(y = " # Candidates in Each Party")


# In the chart below, we analyzed the political party affiliations of the 2011-2012 candidates (in the top ten electoral vote states) for the House of Representative. What we found was interesting. California, which leans more Democratic than Republican had more Republican candidates running for the House of Rep. Also, what we also found interesting was that several states (Florida, Ohio, N.Carolina, N.Jersey, and Pennsylvania) had just one party running for the house. We're not sure why this is, but we think that maybe it's because those states are primarily supportive of that particular party (whether Democrat or Republican) and this support is so strong that it probably makes candidates in the opposing party not run. This is just a hypothesis.  
```




```{r, warning=FALSE, message=FALSE}

# JOINED DATA

#rm(contributions, committees)
joined_data <- committees %>%
   inner_join(contributions, by = "cmte_id")
```

```{r, warning=FALSE, message=FALSE}
filtered_data <- joined_data %>%
  filter( cmte_state == c("CA", "FL", "GA", "IL", "MI", "NC", "NJ", "NY", "OH", "PA", "TX")) 
```

```{r, warning=FALSE, message=FALSE}
joined_data
```







